<style>
  .custom-contact {
    padding: 5rem 0 !important;
    background: linear-gradient(135deg, #ffffff 0%, var(--light-bg) 50%, #ffffff 100%) !important;
  }
  .custom-contact-container {
    max-width: 1200px !important;
    margin: 0 auto !important;
    padding: 0 1.5rem !important;
    position: relative !important;
    z-index: 2 !important;
  }
  .custom-contact-section-header {
    text-align: center !important;
    margin-bottom: 4rem !important;
  }
  .custom-contact-section-title {
    font-size: 4.5rem !important;
    font-weight: 700 !important;
    margin-bottom: 1.5rem !important;
    color: var(--text-primary) !important;
    background: linear-gradient(135deg, var(--text-primary) 0%, var(--primary-color) 100%) !important;
    -webkit-background-clip: text !important;
    background-clip: text !important;
    -webkit-text-fill-color: transparent !important;
  }
  .custom-contact-section-subtitle {
    font-size: 1.2rem !important;
    color: var(--text-secondary) !important;
    max-width: 700px !important;
    margin: 0 auto !important;
    line-height: 1.7 !important;
  }
  .custom-contact-grid {
    display: grid !important;
    grid-template-columns: 1fr 1fr !important;
    gap: 4rem !important;
    margin-top: 3rem !important;
  }
  @media (max-width: 1024px) {
    .custom-contact-grid {
      grid-template-columns: 1fr !important;
      gap: 2rem !important;
    }
  }
  .custom-contact-info {
    padding: 2rem !important;
    border-radius: 1rem !important;
  }
  .custom-contact-item {
    display: flex !important;
    align-items: center !important;
    gap: 1rem !important;
    margin-bottom: 1.5rem !important;
  }
  .custom-contact-icon {
    width: 50px !important;
    height: 50px !important;
    background: var(--gradient-primary) !important;
    border-radius: 50% !important;
    display: flex !important;
    align-items: center !important;
    justify-content: center !important;
    color: var(--white) !important;
    font-size: 1.5rem !important;
  }
  .custom-contact-form {
    background: var(--white) !important;
    border-radius: 1rem !important;
    box-shadow: none !important;
  }
  .custom-contact-form-group {
    margin-bottom: 1.5rem !important;
  }
  .custom-contact-form-label {
    display: block !important;
    margin-bottom: 0.5rem !important;
    font-weight: 500 !important;
    color: var(--text-primary) !important;
  }
  .custom-contact-form-input,
  .custom-contact-form-select,
  .custom-contact-form-textarea {
    width: 100% !important;
    padding: 0.75rem !important;
    border: 1px solid var(--border-color) !important;
    border-radius: 0.5rem !important;
    font-size: 1.5rem !important;
    transition: border-color 0.3s ease !important;
  }
  .custom-contact-form-input:focus,
  .custom-contact-form-select:focus,
  .custom-contact-form-textarea:focus {
    outline: none !important;
    border-color: var(--primary-color) !important;
  }
  .custom-contact-form-textarea {
    resize: vertical !important;
    min-height: 120px !important;
  }
  .custom-contact-form-submit {
    background: var(--gradient-primary) !important;
    color: var(--white) !important;
    padding: 1rem 2rem !important;
    border: none !important;
    border-radius: 0.5rem !important;
    font-size: 1.5rem !important;
    font-weight: 600 !important;
    cursor: pointer !important;
    transition: all 0.3s ease !important;
    display: flex !important;
    align-items: center !important;
    gap: 0.7rem !important;
    box-shadow: 0 2px 8px rgba(37, 99, 235, 0.08) !important;
  }
  .custom-contact-form-submit:hover {
    background: var(--primary-dark) !important;
    transform: translateY(-2px) scale(1.03) !important;
    box-shadow: 0 8px 24px rgba(37, 99, 235, 0.15) !important;
  }
</style>

<section id="contact" class="custom-contact">
  <div class="custom-contact-container">
    <div class="custom-contact-section-header">
      <h2 class="custom-contact-section-title">{{ section.settings.title }}</h2>
      <div class="custom-contact-section-subtitle">{{ section.settings.subtitle }}</div>
    </div>
    <div class="custom-contact-grid">
      <div class="custom-contact-info">
        <h3 style="margin-bottom: 1.5rem; font-size: 2rem !important; font-weight: bold !important;">Informations de Contact</h3>
        {% for block in section.blocks %}
          <div class="custom-contact-item">
            <div class="custom-contact-icon"><i class="{{ block.settings.icon }}"></i></div>
            <div>
              <h4>{{ block.settings.label }}</h4>
              <p>{{ block.settings.value }}</p>
            </div>
          </div>
        {% endfor %}
      </div>
      <div class="custom-contact-form">
        {% form 'contact' %}
          <h3 style="margin-bottom: 1.5rem; font-size: 2rem !important; font-weight: bold !important;">Demande de Consultation</h3>
          <div class="custom-contact-form-group">
            <label class="custom-contact-form-label" for="ContactFormName">Nom complet *</label>
            <input class="custom-contact-form-input" id="ContactFormName" name="contact[name]" type="text" required>
          </div>
          <div class="custom-contact-form-group">
            <label class="custom-contact-form-label" for="ContactFormEmail">Email *</label>
            <input class="custom-contact-form-input" id="ContactFormEmail" name="contact[email]" type="email" required>
          </div>
          <div class="custom-contact-form-group">
            <label class="custom-contact-form-label" for="ContactFormPhone">Téléphone *</label>
            <input class="custom-contact-form-input" id="ContactFormPhone" name="contact[phone]" type="tel" required>
          </div>
          <div class="custom-contact-form-group">
            <label class="custom-contact-form-label" for="ContactFormService">Service souhaité *</label>
            <select id="ContactFormService" name="contact[Service souhaité]" class="custom-contact-form-select" required>
              <option value="">Sélectionnez un service</option>
              <option value="recouvrement">Recouvrement de Créances</option>
              <option value="immobilier">Préparation Dossier Immobilier</option>
              <option value="marches-publics">Assistance Marchés Publics</option>
              <option value="formalites-greffe">Formalités au Greffe</option>
              <option value="droit-etrangers">Accompagnement Droit des Étrangers</option>
              <option value="autre">Autre</option>
            </select>
          </div>
          <div class="custom-contact-form-group">
            <label class="custom-contact-form-label" for="ContactFormMessage">Description de votre situation</label>
            <textarea class="custom-contact-form-textarea" id="ContactFormMessage" name="contact[body]" placeholder="Décrivez brièvement votre situation et vos besoins..."></textarea>
          </div>
          <button class="custom-contact-form-submit" type="submit">
            <i class="fas fa-paper-plane"></i>
            Envoyer la Demande
          </button>
        {% endform %}
      </div>
    </div>
  </div>
</section>

<script>
function showFloatingAlert(message, type = 'success') {
  // Remove any existing alert
  var oldAlert = document.getElementById('custom-floating-alert');
  if (oldAlert) oldAlert.remove();

  var alert = document.createElement('div');
  alert.id = 'custom-floating-alert';
  alert.innerHTML = `
    <span>${message}</span>
    <button id="custom-floating-alert-close" style="background:none;border:none;color:inherit;font-size:2rem;line-height:1;cursor:pointer;margin-left:1.5rem;">&times;</button>
  `;
  alert.style.position = 'fixed';
  alert.style.top = '40px';
  alert.style.left = '50%';
  alert.style.transform = 'translateX(-50%) scale(0.95)';
  alert.style.zIndex = '9999';
  alert.style.minWidth = '380px';
  alert.style.maxWidth = '98vw';
  alert.style.display = 'flex';
  alert.style.alignItems = 'center';
  alert.style.justifyContent = 'center';
  alert.style.gap = '1rem';
  alert.style.padding = '1.7rem 3.2rem';
  alert.style.borderRadius = '1.1rem';
  alert.style.boxShadow = '0 8px 32px rgba(0,0,0,0.18)';
  alert.style.fontWeight = 'bold';
  alert.style.fontSize = '1.7rem';
  alert.style.color = '#fff';
  alert.style.opacity = '0';
  alert.style.pointerEvents = 'auto';
  alert.style.transition = 'opacity 0.4s, transform 0.4s';
  alert.style.cursor = 'default';
  if (type === 'success') {
    alert.style.background = 'linear-gradient(90deg, #4ade80, #22d3ee)';
  } else {
    alert.style.background = 'linear-gradient(90deg, #f87171, #fbbf24)';
  }
  document.body.appendChild(alert);
  setTimeout(function() {
    alert.style.opacity = '1';
    alert.style.transform = 'translateX(-50%) scale(1)';
  }, 50);
  // Close button
  document.getElementById('custom-floating-alert-close').onclick = function() {
    alert.style.opacity = '0';
    alert.style.transform = 'translateX(-50%) scale(0.95)';
    setTimeout(function() { alert.remove(); }, 400);
  };
  // Auto close after 7s
  setTimeout(function() {
    if (document.body.contains(alert)) {
      alert.style.opacity = '0';
      alert.style.transform = 'translateX(-50%) scale(0.95)';
      setTimeout(function() { if (alert.parentNode) alert.remove(); }, 400);
    }
  }, 7000);
}

document.addEventListener('DOMContentLoaded', function() {
  var contactForm = document.querySelector('.custom-contact-form form');
  if (contactForm) {
    var submitBtn = contactForm.querySelector('.custom-contact-form-submit');
    contactForm.addEventListener('submit', function() {
      if (submitBtn) {
        submitBtn.disabled = true;
        submitBtn.style.opacity = '0.6';
        submitBtn.style.pointerEvents = 'none';
      }
      // Set flag to show success alert after reload
      sessionStorage.setItem('contactFormSubmitted', '1');
    });
  }

  // Show success alert if Shopify form was submitted successfully (after reload)
  var successMessage = document.querySelector('.form-status.form-status--success');
  if (successMessage || sessionStorage.getItem('contactFormSubmitted') === '1') {
    showFloatingAlert('Votre demande a bien été envoyée. Merci de nous avoir contactés!', 'success');
    sessionStorage.removeItem('contactFormSubmitted');
  }

  // Show failure alert if Shopify form submission failed
  var errorMessage = document.querySelector('.form-status.form-status--error');
  if (errorMessage) {
    showFloatingAlert('Une erreur est survenue lors de l\'envoi de votre demande. Veuillez vérifier les champs et réessayer.', 'error');
    sessionStorage.removeItem('contactFormSubmitted');
  }
});
</script>

{% schema %}
{
  "name": "Custom Contact Section",
  "settings": [
    {
      "type": "text",
      "id": "title",
      "label": "Section Title",
      "default": "Contactez-nous"
    },
    {
      "type": "textarea",
      "id": "subtitle",
      "label": "Section Subtitle",
      "default": "Obtenez une consultation gratuite pour évaluer votre situation"
    }
  ],
  "blocks": [
    {
      "type": "info",
      "name": "Contact Info",
      "settings": [
        { "type": "text", "id": "icon", "label": "Font Awesome Icon (e.g. fas fa-phone)", "default": "fas fa-phone" },
        { "type": "text", "id": "label", "label": "Label", "default": "Téléphone" },
        { "type": "text", "id": "value", "label": "Value", "default": "01 23 45 67 89" }
      ]
    }
  ],
  "presets": [
    {
      "name": "Custom Contact Section",
      "category": "Custom"
    }
  ]
}
{% endschema %}
